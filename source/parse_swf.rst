======================================
JSON 化ツール
======================================

起動を高速化する (parse_swf)
============================

起動が遅い場合、SWF ファイルを事前にパースしておき、その結果のオブジェクトを Pex に渡すことで起動を高速化できる場合があります。

SWF ファイルを事前にパースするには Pex と一緒に配布されている parse_swf を使います.

次のコマンドを実行することで SWF ファイルをパースした結果の JSON ファイル (example.json) が作成されます。

::

	node parse_swf -o example.json example.swf


作成された JSON ファイルの先頭に "var swfObj="、末尾に ";" を加え、example_json.js という名前で保存することでパース結果のオブジェクトを swfObj という名前で定義することができます。


この作業は次のコマンドを実行することで省略できます。

::

	node parse_swf --var swfObj -o example_json.js example.swf



example_json.js を pex.min.js 同様読み込み、Pex の第1引数に swfObj を渡します。

.. code-block:: html

	<script type="text/javascript" src="example.js"></script>
	<script type="text/javascript" src="pex.min.js"></script>
	<script type="text/javascript">
	var option = {};
	var pex = new Pex(swfObj, "container", option);
	</script>


オプション
**********

parse_swf には以下のオプションが用意されています。

+---------------------+-------------------------------------------------------------------------------------------------------------+
| オプション名        | 概要                                                                                                        |
+=====================+=============================================================================================================+
| -h, --help          | ヘルプを表示します                                                                                          |
+---------------------+-------------------------------------------------------------------------------------------------------------+
| -o filename         | 出力ファイル名を指定します。デフォルトは標準出力です。                                                      |
+---------------------+-------------------------------------------------------------------------------------------------------------+
| --var variable_name | 出力の先頭に "var variable_name="、末尾に ";" を加えます。                                                  |
+---------------------+-------------------------------------------------------------------------------------------------------------+
| --android           | Android 用にパースします。透過 PNG の結果に影響します。                                                     |
+---------------------+-------------------------------------------------------------------------------------------------------------+
| --reduce-lines num  | パスを間引く値を指定します。値が大きいほどファイルサイズと描画負荷を軽減しますが、描画精度を落とします。    |
+---------------------+-------------------------------------------------------------------------------------------------------------+


注意点
******
- parse_swf をご利用になるためには node-canvas のインストールが必要です。
- 透過 JPEG を使用している場合は画像が正しく表示されません。

後方互換性について

- Pex 本体の更新により旧バージョンの parse_swf で生成した JSON だと動作しなくなる可能性があります。本体更新の際には必ずご確認ください。また、バージョン違いにより動作しない場合はブラウザコンソールに error メッセージとしてその旨が表示されます。
